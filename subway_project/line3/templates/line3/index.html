<!DOCTYPE html>
<html>
<head>
    <title>3호선 노선도</title>
    {% load static %} 
    <link rel="stylesheet" type="text/css" href="{% static 'line3/style.css' %}">
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh; /* 전체 높이를 사용하여 가운데 정렬 */
        }
        .controls {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }
        button {
            font-size: 20px; /* 버튼 크기 */
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        .image-container {
            width: 100%;
            height: 80vh; /* 브라우저 높이의 80% */
            overflow: scroll;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        img {
            max-width: none; /* 이미지가 컨테이너를 벗어날 수 있도록 설정 */
            height: auto;
            width: 50%; /* 기본 크기 */
            transition: width 0.5s, transform 0.5s; /* 부드러운 전환 효과 */
            position: absolute; /* 드래그를 위해 절대 위치 설정 */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* 이미지 초기 위치 중앙으로 설정 */
            overflow: auto;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="resizeImage('larger')">확대</button>
        <button onclick="resizeImage('smaller')">축소</button>
    </div>

    <div class="image-container" id="image-container">
        <img id="line3-map" src="{% static 'line3/line3.png' %}" alt="3호선 노선도" class="line3-map">
    </div>
    
    <script>
        function resizeImage(action) {
            const img = document.getElementById('line3-map');
            let currentWidth = img.style.width ? parseInt(img.style.width) : 50;
            if (action === 'larger') {
                currentWidth = Math.min(currentWidth + 20, 200);
            } else if (action === 'smaller') {
                currentWidth = Math.max(currentWidth - 20, 50);
            }
            img.style.width = currentWidth + '%';
            img.style.top = '50%';
            img.style.left = '50%';
            img.style.transform = 'translate(-50%, -50%)';
            updateButtons(currentWidth);
        }
        
        // /* 최대 확대일 때 최소 축소일 때 확대, 축소 버튼 생략 */
        // function updateButtons(currentWidth) {  
        //     const largerButton = document.getElementById('larger-button');
        //     const smallerButton = document.getElementById('smaller-button');
        //     largerButton.style.display = currentWidth >= 200 ? 'none' : 'block';
        //     smallerButton.style.display = currentWidth <= 50 ? 'none' : 'block';
        // }

        document.getElementById('image-container').addEventListener('wheel', function(event) {
            event.preventDefault();
            if (event.deltaY < 0) {
                resizeImage('larger');
            } else {
                resizeImage('smaller');
            }
        });


        // 마우스 이벤트 처리

        let isDragging = true;
        let startX, startY, imgStartX, imgStartY;

        const container = document.getElementById('image-container');
        const img = document.getElementById('line3-map');

        //마우스 버튼 눌렀을 때
        container.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            imgStartX = img.offsetLeft;
            imgStartY = img.offsetTop;
        });

        //마우스 움직일 때
        document.addEventListener('mousemove', (e) => {
            if (isDragging){
            e.preventDefault();
            const dx = (e.clientX - startX) * 13; // 이동 거리를 더 크게 조정
            const dy = (e.clientY - startY) * 13; // 이동 거리를 더 크게 조정
            img.style.left = `${imgStartX + dx}px`;
            img.style.top = `${imgStartY + dy}px`;
            }
            isDragging = false; // 마우스를 움직이고 나서 드래그상태 해제
        });

        // 마우스 버튼 뗐을 때 드래그 해제
        document.addEventListener('mouseup', () => {
            isDragging = false;
        });

        // 마우스를 건드리지 않을 때
        document.addEventListener('mouseleave', () => {
            isDragging = false;
        });

    </script>
</body>
</html>